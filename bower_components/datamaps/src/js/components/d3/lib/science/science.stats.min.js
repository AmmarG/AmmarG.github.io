!function(){function t(t,n){if(!t||!n||t.length!==n.length)return!1;for(var r=t.length,e=-1;++e<r;)if(t[e]!==n[e])return!1;return!0}function n(t){for(var n=t.length,r=-1;++r<n;)if(!isFinite(t[r]))return!1;return!0}function r(t,n){for(var r=n+1;r<t.length&&0===t[r];)r++;return r}science.stats={},science.stats.bandwidth={nrd0:function(t){var n=Math.sqrt(science.stats.variance(t));return(lo=Math.min(n,science.stats.iqr(t)/1.34))||(lo=n)||(lo=Math.abs(t[1]))||(lo=1),.9*lo*Math.pow(t.length,-.2)},nrd:function(t){var n=science.stats.iqr(t)/1.34;return 1.06*Math.min(Math.sqrt(science.stats.variance(t)),n)*Math.pow(t.length,-.2)}},science.stats.distance={euclidean:function(t,n){for(var r,e=t.length,a=-1,i=0;++a<e;)i+=(r=t[a]-n[a])*r;return Math.sqrt(i)},manhattan:function(t,n){for(var r=t.length,e=-1,a=0;++e<r;)a+=Math.abs(t[e]-n[e]);return a},minkowski:function(t){return function(n,r){for(var e=n.length,a=-1,i=0;++a<e;)i+=Math.pow(Math.abs(n[a]-r[a]),t);return Math.pow(i,1/t)}},chebyshev:function(t,n){for(var r,e=t.length,a=-1,i=0;++a<e;)(r=Math.abs(t[a]-n[a]))>i&&(i=r);return i},hamming:function(t,n){for(var r=t.length,e=-1,a=0;++e<r;)t[e]!==n[e]&&a++;return a},jaccard:function(t,n){for(var r=t.length,e=-1,a=0;++e<r;)t[e]===n[e]&&a++;return a/r},braycurtis:function(t,n){for(var r,e,a=t.length,i=-1,s=0,c=0;++i<a;)r=t[i],e=n[i],s+=Math.abs(r-e),c+=Math.abs(r+e);return s/c}},science.stats.erf=function(t){var n=t<0?-1:1;t<0&&(n=-1,t=-t);var r=1/(1+.3275911*t);return n*(1-((((1.061405429*r-1.453152027)*r+1.421413741)*r-.284496736)*r+.254829592)*r*Math.exp(-t*t))},science.stats.phi=function(t){return.5*(1+science.stats.erf(t/Math.SQRT2))},science.stats.kernel={uniform:function(t){return t<=1&&t>=-1?.5:0},triangular:function(t){return t<=1&&t>=-1?1-Math.abs(t):0},epanechnikov:function(t){return t<=1&&t>=-1?.75*(1-t*t):0},quartic:function(t){if(t<=1&&t>=-1){var n=1-t*t;return.9375*n*n}return 0},triweight:function(t){if(t<=1&&t>=-1){var n=1-t*t;return 35/32*n*n*n}return 0},gaussian:function(t){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*t*t)},cosine:function(t){return t<=1&&t>=-1?Math.PI/4*Math.cos(Math.PI/2*t):0}},science.stats.kde=function(){function t(t,a){var i=e.call(this,r);return t.map(function(t){for(var e=-1,a=0,s=r.length;++e<s;)a+=n((t-r[e])/i);return[t,a/i/s]})}var n=science.stats.kernel.gaussian,r=[],e=science.stats.bandwidth.nrd;return t.kernel=function(r){return arguments.length?(n=r,t):n},t.sample=function(n){return arguments.length?(r=n,t):r},t.bandwidth=function(n){return arguments.length?(e=science.functor(n),t):e},t},science.stats.kmeans=function(){function n(n){for(var i,s,c,u,o,f,h,l=n.length,v=[],g=[],d=1,M=0,b=function(n,r){var e=r.length;if(n>e)return null;for(var a,i,s,c=[],u=[],o={},f=0,h=0;h<n;){if(f===e)return null;var l=Math.floor(Math.random()*e);if(!(l in o)){for(o[l]=1,f++,i=r[l],s=!0,a=0;a<h;a++)if(t(i,c[a])){s=!1;break}s&&(c[h]=i,u[h]=l,h++)}}return c}(a,n);d&&M<e;){for(c=-1;++c<a;)g[c]=0;for(s=-1;++s<l;){for(u=n[s],f=1/0,c=-1;++c<a;)(o=r.call(this,b[c],u))<f&&(f=o,h=c);g[v[s]=h]++}for(i=[],s=-1;++s<l;)if(u=v[s],null==(o=i[u]))i[u]=n[s].slice();else for(c=-1;++c<o.length;)o[c]+=n[s][c];for(c=-1;++c<a;)for(u=i[c],o=1/g[c],s=-1;++s<u.length;)u[s]*=o;for(d=0,c=-1;++c<a;)if(!t(i[c],b[c])){d=1;break}b=i,M++}return{assignments:v,centroids:b}}var r=science.stats.distance.euclidean,e=1e3,a=1;return n.k=function(t){return arguments.length?(a=t,n):a},n.distance=function(t){return arguments.length?(r=t,n):r},n},science.stats.hcluster=function(){function t(t){var e,a,i,s,c,u,o,f,h=t.length,l=[],v=[],g=[],d=[];for(o=-1;++o<h;)for(l[o]=0,g[o]=[],f=-1;++f<h;)g[o][f]=o===f?1/0:n(t[o],t[f]),g[o][l[o]]>g[o][f]&&(l[o]=f);for(o=-1;++o<h;)d[o]=[],d[o][0]={left:null,right:null,dist:0,centroid:t[o],size:1,depth:0},v[o]=1;for(c=0;c<h-1;c++){for(e=0,o=0;o<h;o++)g[o][l[o]]<g[e][l[e]]&&(e=o);for(a=l[e],i=d[e][0],s=d[a][0],newCluster={left:i,right:s,dist:g[e][a],centroid:function(t,n,r,e){for(var a=[],i=t+r,s=n.length,c=-1;++c<s;)a[c]=(t*n[c]+r*e[c])/i;return a}(i.size,i.centroid,s.size,s.centroid),size:i.size+s.size,depth:1+Math.max(i.depth,s.depth)},d[e].splice(0,0,newCluster),v[e]+=v[a],f=0;f<h;f++)switch(r){case"single":g[e][f]>g[a][f]&&(g[f][e]=g[e][f]=g[a][f]);break;case"complete":g[e][f]<g[a][f]&&(g[f][e]=g[e][f]=g[a][f]);break;case"average":g[f][e]=g[e][f]=(v[e]*g[e][f]+v[a]*g[a][f])/(v[e]+v[f])}for(g[e][e]=1/0,o=0;o<h;o++)g[o][a]=g[a][o]=1/0;for(f=0;f<h;f++)l[f]==a&&(l[f]=e),g[e][f]<g[e][l[e]]&&(l[e]=f);u=newCluster}return u}var n=science.stats.distance.euclidean,r="simple";return t.distance=function(r){return arguments.length?(n=r,t):n},t},science.stats.iqr=function(t){var n=science.stats.quantiles(t,[.25,.75]);return n[1]-n[0]},science.stats.loess=function(){function t(t,s,c){var u,o=t.length;if(o!==s.length)throw{error:"Mismatched array lengths"};if(0==o)throw{error:"At least one point required."};if(arguments.length<3)for(c=[],u=-1;++u<o;)c[u]=1;if(n(t),n(s),n(c),function(t){for(var n=t.length,r=0;++r<n;)if(t[r-1]>=t[r])return!1}(t),1==o)return[s[0]];if(2==o)return[s[0],s[1]];var f=Math.floor(e*o);if(f<2)throw{error:"Bandwidth too small."};var h=[],l=[],v=[];for(u=-1;++u<o;)h[u]=0,l[u]=0,v[u]=1;for(var g=-1;++g<=a;){var d,M=[0,f-1];for(u=-1;++u<o;){d=t[u],u>0&&function(t,n,e,a){var i=a[0],s=r(n,a[1]);if(s<t.length&&t[s]-t[e]<t[e]-t[i]){var c=r(n,i);a[0]=c,a[1]=s}}(t,c,u,M);for(var b=M[0],m=M[1],p=t[u]-t[b]>t[m]-t[u]?b:m,w=0,k=0,q=0,z=0,y=0,I=Math.abs(1/(t[p]-d)),N=b;N<=m;++N){var x=t[N],C=s[N],P=x*(E=function(t){return(t=1-t*t*t)*t*t}((N<u?d-x:x-d)*I)*v[N]*c[N]);w+=E,k+=P,q+=x*P,z+=C*E,y+=C*P}var j=k/w,A=z/w,B=y/w,F=q/w,Q=Math.sqrt(Math.abs(F-j*j))<i?0:(B-j*A)/(F-j*j),R=A-Q*j;h[u]=Q*d+R,l[u]=Math.abs(s[u]-h[u])}if(g===a)break;var S=l.slice();S.sort();var T=S[Math.floor(o/2)];if(Math.abs(T)<i)break;var D,E;for(u=-1;++u<o;)D=l[u]/(6*T),v[u]=D>=1?0:(E=1-D*D)*E}return h}var e=.3,a=2,i=1e-12;return t.bandwidth=function(n){return arguments.length?(e=n,t):n},t.robustnessIterations=function(n){return arguments.length?(a=n,t):n},t.accuracy=function(n){return arguments.length?(i=n,t):n},t},science.stats.mean=function(t){var n=t.length;if(0===n)return NaN;for(var r=0,e=-1;++e<n;)r+=(t[e]-r)/(e+1);return r},science.stats.median=function(t){return science.stats.quantiles(t,[.5])[0]},science.stats.mode=function(t){for(var n,r,e,a=(t=t.slice().sort(science.ascending)).length,i=-1,s=i,c=null,u=0;++i<a;)(e=t[i])!==c&&((r=i-s)>u&&(u=r,n=c),c=e,s=i);return n},science.stats.quantiles=function(t,n){var r=(t=t.slice().sort(science.ascending)).length-1;return n.map(function(n){if(0===n)return t[0];if(1===n)return t[r];var e=1+n*r,a=Math.floor(e),i=e-a,s=t[a-1];return 0===i?s:s+i*(t[a]-s)})},science.stats.variance=function(t){var n=t.length;if(n<1)return NaN;if(1===n)return 0;for(var r=science.stats.mean(t),e=-1,a=0;++e<n;){var i=t[e]-r;a+=i*i}return a/(n-1)}}();